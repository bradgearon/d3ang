"use strict";angular.module("d3App.services",[]).factory("graphSvc",[function(){var a=function(){};return a.prototype.init=function(a){if(a&&a.element){this.graphImpl=new Rickshaw.Graph({element:a.element,width:a.width,height:a.height,renderer:"area",stroke:!0,preserve:!0,series:a.data});var b="glow",c=new Rickshaw.Graph.Axis.Time({graph:this.graphImpl,ticksTreatment:b,timeFixture:new Rickshaw.Fixtures.Time.Local}),d=new Rickshaw.Graph.Axis.Y({graph:this.graphImpl,tickFormat:Rickshaw.Fixtures.Number.formatKMBT,ticksTreatment:b});this.graphImpl.render(),c.render(),d.render()}return this},a.prototype.update=function(){this.graphImpl.update()},a.prototype.setSeries=function(a){if(a)for(var b=0;b<a.length;b++)this.graphImpl.series[b]&&(this.graphImpl.series[b]=a[b])},a.prototype.$get=function(){return new a},a}]),angular.module("d3App.directives",["ng","d3App.services"]).directive("graph",["graphSvc",function(a){return{scope:{data:"=graphData",domain:"=graphDomain",type:"=graphType"},link:function(b,c){b.$watch("data",function(d){d&&(b.graph||(b.graph=(new a).init({element:c.get(0),width:c.width(),height:c.height(),data:d})),b.graph.setSeries(d),b.graph.update())}),b.$watch("type",function(a){switch(a){case"load":break;case"time":}}),b.$watch("domain",function(a){a&&(graph.panMode=b.panMode,graph.x.domain(a))})}}}]),angular.module("d3App",["d3App.directives"]).config(["$routeProvider","$locationProvider",function(a,b){b.html5Mode(!0),a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("d3App").controller("MainCtrl",["$scope",function(a){for(var b=new Rickshaw.Color.Palette({scheme:"classic9"}),c=[],d=[],e=["Moscow","Shanghai","Amsterdam","Paris","Tokyo","London","New York"],f=0;f<e.length;f++)c.push(b.color()),d.push([]);for(var g=new Rickshaw.Fixtures.RandomData(150),h=0;150>h;h++)g.addData(d);var i=function(a){for(a=[]||a,h=0;h<e.length;h++)a.push({color:c[h],data:d[h],name:e[h]});return a};a.doSomething=function(){console.log(arguments),console.log(this)};var j=0,k=function(){console.log("adding data"),g.removeData(d),g.addData(d),a.data=i(),a.apply&&(a.$apply(),console.log("apply called"))};a.$watch("speed",function(b){j&&clearInterval(j),a.speed=b||3e3,j=setInterval(k,a.speed)}),a.data=i(),a.apply=!0,a.speed=3e3}]);